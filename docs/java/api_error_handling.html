<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[Java å¼€å‘å®æˆ˜] ä½ è¿˜åœ¨ç»Ÿä¸€è¿”å› ApiResultBean å—ï¼Ÿâœ‹ duck ä¸å¿…ï¼Œå¿«æ¥çœ‹ API é”™è¯¯å¤„ç†çš„æœ€ä½³å®è·µ âœ”ï¸ | lcomplete çš„æŠ€æœ¯åˆ†äº«</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="åˆ†äº«Javaã€.NETã€Javascriptã€æ•ˆç‡ã€è½¯ä»¶å·¥ç¨‹ã€ç¼–ç¨‹è¯­è¨€ç­‰æŠ€æœ¯çŸ¥è¯†ã€‚">
    
    <link rel="preload" href="/TechShare/assets/css/0.styles.1b1aafba.css" as="style"><link rel="preload" href="/TechShare/assets/js/app.832ed307.js" as="script"><link rel="preload" href="/TechShare/assets/js/3.df2e8613.js" as="script"><link rel="preload" href="/TechShare/assets/js/4.4084e14b.js" as="script"><link rel="preload" href="/TechShare/assets/js/29.55e38d98.js" as="script"><link rel="preload" href="/TechShare/assets/js/17.73d469d0.js" as="script"><link rel="prefetch" href="/TechShare/assets/js/1.a8de44b1.js"><link rel="prefetch" href="/TechShare/assets/js/10.d9040519.js"><link rel="prefetch" href="/TechShare/assets/js/11.3714bb5a.js"><link rel="prefetch" href="/TechShare/assets/js/12.8cca92f5.js"><link rel="prefetch" href="/TechShare/assets/js/13.9f4edf67.js"><link rel="prefetch" href="/TechShare/assets/js/14.bc9301df.js"><link rel="prefetch" href="/TechShare/assets/js/15.376945b8.js"><link rel="prefetch" href="/TechShare/assets/js/16.03966f52.js"><link rel="prefetch" href="/TechShare/assets/js/18.9538cfdf.js"><link rel="prefetch" href="/TechShare/assets/js/19.96589def.js"><link rel="prefetch" href="/TechShare/assets/js/20.4b2c9682.js"><link rel="prefetch" href="/TechShare/assets/js/21.40277eb5.js"><link rel="prefetch" href="/TechShare/assets/js/22.a0b85c42.js"><link rel="prefetch" href="/TechShare/assets/js/23.1e025aa6.js"><link rel="prefetch" href="/TechShare/assets/js/24.aeb7e5bc.js"><link rel="prefetch" href="/TechShare/assets/js/25.be3a0915.js"><link rel="prefetch" href="/TechShare/assets/js/26.25de23d4.js"><link rel="prefetch" href="/TechShare/assets/js/27.9f871e83.js"><link rel="prefetch" href="/TechShare/assets/js/28.b1c93b43.js"><link rel="prefetch" href="/TechShare/assets/js/30.ba998780.js"><link rel="prefetch" href="/TechShare/assets/js/31.292fee50.js"><link rel="prefetch" href="/TechShare/assets/js/32.39cb9a9f.js"><link rel="prefetch" href="/TechShare/assets/js/33.0e247018.js"><link rel="prefetch" href="/TechShare/assets/js/34.7fb8b6e8.js"><link rel="prefetch" href="/TechShare/assets/js/35.8ae32673.js"><link rel="prefetch" href="/TechShare/assets/js/36.ea51f37d.js"><link rel="prefetch" href="/TechShare/assets/js/37.1f0184f7.js"><link rel="prefetch" href="/TechShare/assets/js/38.2ad83bc8.js"><link rel="prefetch" href="/TechShare/assets/js/39.38345791.js"><link rel="prefetch" href="/TechShare/assets/js/40.4c7c2629.js"><link rel="prefetch" href="/TechShare/assets/js/41.efb724e4.js"><link rel="prefetch" href="/TechShare/assets/js/42.497f0768.js"><link rel="prefetch" href="/TechShare/assets/js/43.3ed69e90.js"><link rel="prefetch" href="/TechShare/assets/js/44.1efb96aa.js"><link rel="prefetch" href="/TechShare/assets/js/45.3e5ba0be.js"><link rel="prefetch" href="/TechShare/assets/js/46.f932097f.js"><link rel="prefetch" href="/TechShare/assets/js/5.dba33de4.js"><link rel="prefetch" href="/TechShare/assets/js/6.accd1220.js"><link rel="prefetch" href="/TechShare/assets/js/7.f5c6a883.js"><link rel="prefetch" href="/TechShare/assets/js/8.48600e5d.js"><link rel="prefetch" href="/TechShare/assets/js/9.cf31c120.js">
    <link rel="stylesheet" href="/TechShare/assets/css/0.styles.1b1aafba.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TechShare/" class="home-link router-link-active"><!----> <span class="site-name">lcomplete çš„æŠ€æœ¯åˆ†äº«</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/lcomplete/TechShare" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/lcomplete/TechShare" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/TechShare/summary/" class="sidebar-link">ç›®å½•</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>é‡ç”Ÿæ¶æ„å¸ˆå‘¨åˆŠ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/letter/001.html" class="sidebar-link">001 tech letter æ¯å‘¨åˆ†äº«ï¼ˆä½ä»£ç ã€ä¿¡æ¯ç®¡ç†ï¼‰</a></li><li><a href="/TechShare/docs/letter/002.html" class="sidebar-link">002 tech letter æ¯å‘¨åˆ†äº«ï¼ˆWeb 3.0ã€å…³äºå¥½å“å‘³çš„å•†ä¸šæ¨¡å¼ï¼‰</a></li><li><a href="/TechShare/docs/letter/003.html" class="sidebar-link">003 tech letter æ¯å‘¨åˆ†äº«ï¼ˆwasmCloudã€åè„†å¼±ï¼‰</a></li><li><a href="/TechShare/docs/letter/004.html" class="sidebar-link">004 å¤‡å—ç¨‹åºå‘˜å–œçˆ±çš„æš—é»‘ä¸»é¢˜ã€ç¨‹åºå‘˜çš„è‹±è¯­æœ‰å¤šé‡è¦ã€Newsletter èµ„æºåˆ†äº«</a></li><li><a href="/TechShare/docs/letter/005.html" class="sidebar-link">005 IFTTT å’Œ Zapier ä½¿ç”¨å¯¹æ¯”ã€æœ€å¥½çš„æ•ˆç‡ç³»ç»Ÿã€æŠ•å…¥äº§å‡ºæ¯”æœ€é«˜çš„ 3 ä»¶äº‹</a></li><li><a href="/TechShare/docs/letter/006.html" class="sidebar-link">006 ğŸ“’ ä¸äººä¿æŒè”ç³»çš„ç³»ç»Ÿã€ç”¨ä½ä»£ç åº”ç”¨è®¾è®¡äº§å“åŸå‹ã€ä¸‡èƒ½é”¤</a></li><li><a href="/TechShare/docs/letter/007.html" class="sidebar-link">007 ğŸ€ åå¹´åé‡æ–°ä½¿ç”¨ RSS ç»™æˆ‘å¸¦æ¥çš„å·¨å˜</a></li><li><a href="/TechShare/docs/letter/008.html" class="sidebar-link">008 ğŸ“š Notion vs Obsidianã€ç¨‹åºè®¾è®¡ vs è½¯ä»¶å·¥ç¨‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/java/ä¿¯ç°JavaæœåŠ¡ç«¯å¼€å‘.html" class="sidebar-link">ä¿¯ç° Java æœåŠ¡ç«¯å¼€å‘</a></li><li><a href="/TechShare/docs/java/part_one_of_java_engineer_path.html" class="sidebar-link">Java å·¥ç¨‹å¸ˆèƒ½åŠ›æå‡è·¯å¾„ï¼ˆä¸€ï¼‰ï¼šä»ä¸šä½™åˆ°ä¸“ä¸š</a></li><li><a href="/TechShare/docs/java/java_study_way.html" class="sidebar-link">Java å­¦ä¹ å¤§æ³•</a></li><li><a href="/TechShare/docs/java/liquibase.html" class="sidebar-link">[Java å¼€å‘å®æˆ˜] 5 åˆ†é’Ÿæå®š liquibase æ•°æ®åº“ç‰ˆæœ¬æ§åˆ¶</a></li><li><a href="/TechShare/docs/java/unit_test.html" class="sidebar-link">[Java å¼€å‘å®æˆ˜] é«˜çº§å·¥ç¨‹å¸ˆçš„è‡ªæˆ‘ä¿®å…»ä¹‹å•å…ƒæµ‹è¯•ï¼ˆä¸€ï¼‰ï¼šDAO å±‚æµ‹è¯•</a></li><li><a href="/TechShare/docs/java/api_error_handling.html" aria-current="page" class="active sidebar-link">[Java å¼€å‘å®æˆ˜] ä½ è¿˜åœ¨ç»Ÿä¸€è¿”å› ApiResultBean å—ï¼Ÿâœ‹ duck ä¸å¿…ï¼Œå¿«æ¥çœ‹ API é”™è¯¯å¤„ç†çš„æœ€ä½³å®è·µ âœ”ï¸</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« " class="sidebar-link">ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#apiresult-ç°çŠ¶" class="sidebar-link">ApiResult ç°çŠ¶</a></li><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#ä½¿ç”¨-http-çŠ¶æ€ç " class="sidebar-link">ä½¿ç”¨ HTTP çŠ¶æ€ç </a></li><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#api-é”™è¯¯æ¨¡å‹" class="sidebar-link">API é”™è¯¯æ¨¡å‹</a></li><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#spring-api-é”™è¯¯æ¨¡å‹å®æˆ˜" class="sidebar-link">Spring API é”™è¯¯æ¨¡å‹å®æˆ˜</a></li><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#ç»“æŸäº†å—" class="sidebar-link">ç»“æŸäº†å—ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/TechShare/docs/java/api_error_handling.html#å†™åœ¨æœ€å" class="sidebar-link">å†™åœ¨æœ€å</a></li></ul></li><li><a href="/TechShare/docs/java/spring_best_practice.html" class="sidebar-link">Java Spring é¡¹ç›®å¼€å‘æœ€ä½³å®è·µ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ•°æ®åº“</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/db/mysql_standard.html" class="sidebar-link">MySQL æ•°æ®åº“å¼€å‘è§„èŒƒ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è½¯ä»¶å·¥ç¨‹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/engineering/devops.html" class="sidebar-link">ä¸‡å­—é•¿æ–‡å¸¦ä½ å½»åº•ææ‡‚ä»€ä¹ˆæ˜¯ DevOps</a></li><li><a href="/TechShare/docs/engineering/gitflow.html" class="sidebar-link">ç½‘ç«™é¡¹ç›® Git ä½¿ç”¨æµç¨‹å’Œè§„èŒƒ</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/js/remotion.html" class="sidebar-link">ğŸ„ ä½¿ç”¨ React åˆ¶ä½œè§†é¢‘ï¼Œè®©åœ£è¯å¿«ä¹ PSD è‡ªåŠ¨ç”ŸæˆåŠ¨ç”»è§†é¢‘</a></li><li><a href="/TechShare/docs/js/lit_layui.html" class="sidebar-link">ä½¿ç”¨ lit ç¼–å†™ Web Components ç®€åŒ– Layui ä»£ç </a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¼–ç¨‹äººç”Ÿ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/thinking/ç¼–ç çš„é“ä¸ç¦….html" class="sidebar-link">ç¼–ç çš„é“ä¸ç¦…</a></li><li><a href="/TechShare/docs/thinking/ç¨‹åºå‘˜çš„èŒä¸šç´ å…».html" class="sidebar-link">ç¨‹åºå‘˜çš„èŒä¸šç´ å…»</a></li><li><a href="/TechShare/docs/thinking/coder_kpi.html" class="sidebar-link">ç ”å‘è´¨é‡ä¸æ•ˆç‡çš„ç»©æ•ˆæŒ‡æ ‡è®¾è®¡</a></li><li><a href="/TechShare/docs/thinking/quotes.html" class="sidebar-link">ç¼–ç¨‹ç•Œçš„ 51 æ¡åè¨€ä½³å¥</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¼–ç¨‹è¯­è¨€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/lang/ä½¿ç”¨prologè§£å†³çˆ±å› æ–¯å¦æ–‘é©¬éš¾é¢˜.html" class="sidebar-link">ä½¿ç”¨prologè§£å†³çˆ±å› æ–¯å¦æ–‘é©¬éš¾é¢˜</a></li><li><a href="/TechShare/docs/lang/ä¸€æ®µç®€å•çš„rubyçˆ¬è™«ä»£ç .html" class="sidebar-link">ä¸€æ®µç®€å•çš„rubyçˆ¬è™«ä»£ç </a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ•ˆç‡</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TechShare/docs/10x/script.html" class="sidebar-link">[10 å€ç¨‹åºå‘˜] â­è„šæœ¬çš„é­…åŠ›ï¼Œå†…å« js å†™çˆ¬è™«ã€python éªšæ“ä½œç­‰å®ç”¨ä»£ç </a></li><li><a href="/TechShare/docs/10x/terminal.html" class="sidebar-link">[10 å€ç¨‹åºå‘˜] â­51W+ çš„ç»ˆç«¯å‘½ä»¤è¡Œå·¥å…·åŠ©ä½ æˆä¸º 10 å€ç¨‹åºå‘˜</a></li><li><a href="/TechShare/docs/tools/æˆ‘çš„æ•ˆç‡å·¥å…·ç®±.html" class="sidebar-link">æ•ˆç‡å·¥å…·ç®±</a></li><li><a href="/TechShare/docs/tools/n8n.html" class="sidebar-link">ä½¿ç”¨å¼€æºå·¥ä½œæµè‡ªåŠ¨åŒ–å·¥å…· n8n æ‰“é€ ä¸ªäººåŠ©ç†</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="java-å¼€å‘å®æˆ˜-ä½ è¿˜åœ¨ç»Ÿä¸€è¿”å›-apiresultbean-å—-âœ‹-duck-ä¸å¿…-å¿«æ¥çœ‹-api-é”™è¯¯å¤„ç†çš„æœ€ä½³å®è·µ-âœ”ï¸">[Java å¼€å‘å®æˆ˜] ä½ è¿˜åœ¨ç»Ÿä¸€è¿”å› ApiResultBean å—ï¼Ÿâœ‹ duck ä¸å¿…ï¼Œå¿«æ¥çœ‹ API é”™è¯¯å¤„ç†çš„æœ€ä½³å®è·µ âœ”ï¸</h1> <h2 id="ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ">ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ</h2> <p>ç›¸ä¿¡ä¸å°‘ Java å¼€å‘éƒ½åœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¿‡ç±»ä¼¼ <code>ApiResult</code> è¿™æ ·çš„å¯¹è±¡æ¥åŒ…è£… Api è¿”å›ç±»å‹ï¼Œè¿™ç›¸æ¯”ä»€ä¹ˆéƒ½ä¸åŒ…è£…æœ‰ä¸€å®šçš„å¥½å¤„ï¼Œä½†è¿™çœŸçš„å°±æ˜¯æœ€å¥½çš„åšæ³•å—ï¼Ÿ</p> <p>å…³äºå°è£… ResultBean å¯¹è±¡ï¼Œæ™“é£è½»åœ¨ä»–çš„ <a href="https://xwjie.github.io/rule/controller.html" target="_blank" rel="noopener noreferrer">ç¨‹åºå‘˜ä½ ä¸ºä»€ä¹ˆè¿™ä¹ˆç´¯<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç³»åˆ—æ–‡ç« ä¸­æœ‰è¿‡ä¸é”™çš„åˆ†äº«ï¼Œä½†ç»Ÿä¸€å°è£… ResultBean å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§é‡å¤å·¥ä½œï¼Œç§‰æ‰¿ <code>DRY</code> çš„ç†å¿µï¼Œè¿˜æœ‰å¿…è¦å¯¹å…¶ç»§ç»­ä¼˜åŒ–ã€‚</p> <p>ç»Ÿä¸€è¿”å› ApiResult è¿˜ä¸æ˜¯æœ€ä½³å®è·µï¼Œå¿…é¡»ä¸æ–­æ€è€ƒä¼˜åŒ–ï¼Œå°±åƒ React æ‰€æå€¡çš„ <code>Rethinking Best Practices</code> ã€‚</p> <h2 id="apiresult-ç°çŠ¶">ApiResult ç°çŠ¶</h2> <p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªå¸¸è§çš„ ApiResult å¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApiResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¥½å¤„ï¼šå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„å¤„ç†æ–¹å¼ã€‚</p> <p>å­˜åœ¨çš„é—®é¢˜ï¼š</p> <ol><li>åœ¨ç»Ÿä¸€è¿”å› ApiResult çš„æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯æ­£å¸¸è¿”å›ï¼Œä¹Ÿä¼šå¸¦ä¸Š codeã€message å±æ€§ï¼Œ<code>å¤šæ•°æƒ…å†µ</code> ä¸‹å±äº <code>å†—ä½™</code> ã€‚</li> <li><code>Controller</code> å±‚ä»£ç å­˜åœ¨é‡å¤ï¼Œè¿”å›å¯¹è±¡é‡å¤å®šä¹‰ã€åŒ…è£…è°ƒç”¨ç¼–å†™é‡å¤ï¼Œ<code>ä»£ç æ•´æ´åº¦ä¸‹é™</code> ã€‚</li> <li>ç»Ÿä¸€è¿”å› 200 çŠ¶æ€ç ä¸åˆ©äº <code>è¯·æ±‚ç›‘æ§</code> ã€‚</li> <li>ApiResult åŒæ—¶æ‰¿æ‹…äº†Apiç»“æœå’Œé”™è¯¯ç»“æœçš„èŒè´£ï¼Œä¸ç¬¦åˆ <code>å•ä¸€èŒè´£</code> åŸåˆ™ã€‚</li></ol> <p>åƒä¸‹é¢è¿™æ ·ä¸€æ®µè·å–åˆ—è¡¨æ•°æ®çš„ä»£ç ï¼Œè‹¥ä¸æ¶‰åŠä¸šåŠ¡é¢„æœŸå†…çš„è¯·æ±‚éªŒè¯ï¼Œæ˜¯æ²¡å¿…è¦åŒ…è£…ä¸€å±‚ ApiResult çš„ï¼Œä»€ä¹ˆæ˜¯ä¸šåŠ¡é¢„æœŸå†…çš„éªŒè¯å‘¢ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚éä¼šå‘˜æ— æ³•è·å–åˆ—è¡¨ï¼Œä¸šåŠ¡ä¸Šéœ€è¦æé†’ç”¨æˆ·è´­ä¹°ä¼šå‘˜ï¼Œè¿™å±äºåˆæ³•è¯·æ±‚ï¼Œæ­¤æ—¶ä»ç„¶å¯ä»¥ä½¿ç”¨ ApiResult æºå¸¦ code æ˜ç¡®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ApiResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Data</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">ApiResult</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ApiResult è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯ä½¿ç”¨ï¼Œä¸éœ€è¦æ¯ä¸ªåœºæ™¯éƒ½ä½¿ç”¨å®ƒã€‚</p> <p>å½“ API è¶Šæ¥è¶Šå¤šæ—¶ï¼Œç»Ÿä¸€è¿”å› ApiResult çš„é—®é¢˜ä¼šè¢«æ”¾å¤§ï¼Œå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜å‘¢ï¼Ÿè¯·æ¥ç€çœ‹ã€‚</p> <h2 id="ä½¿ç”¨-http-çŠ¶æ€ç ">ä½¿ç”¨ HTTP çŠ¶æ€ç </h2> <p>æœ‰è®¸å¤šé¡¹ç›®é‡‡ç”¨çš„æ–¹å¼æ˜¯ï¼Œåœ¨ API è°ƒç”¨æˆåŠŸæ—¶ä½¿ç”¨æ­£å¸¸çš„æ•°æ®æ¨¡å‹ï¼Œè€Œåœ¨å‡ºç°é”™è¯¯æ—¶ï¼Œè¿”å›ç›¸åº”çš„ <code>HTTP é”™è¯¯ç </code> å’Œæè¿°ä¿¡æ¯ã€‚æˆ‘ä»¬çœ‹ä¸€æ®µ <code>jhipster</code> ä¸­çš„ä»£ç ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/authors/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthorDTO</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuthorDTO</span><span class="token punctuation">&gt;</span></span> authorDTO <span class="token operator">=</span> authorService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ResponseUtil</span><span class="token punctuation">.</span><span class="token function">wrapOrNotFound</span><span class="token punctuation">(</span>authorDTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸»è¦ HTTP çŠ¶æ€ç çš„å«ä¹‰ï¼š</p> <ul><li>1XX â€“ Informational</li> <li>2XX â€“ Success</li> <li>3XX â€“ Redirection</li> <li>4XX â€“ Client Error</li> <li>5XX â€“ Server Error</li></ul> <p>é‡‡ç”¨ HTTP çŠ¶æ€ç å°±ä¸å†éœ€è¦ç»Ÿä¸€è¿”å› ApiResult ï¼Œä½†é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼Œé‚£å°±æ˜¯ ApiResult ä¸­å®šä¹‰çš„ <code>error code</code> å¾ˆéš¾è·Ÿ HTTP é”™è¯¯ç ä¸€ä¸€å¯¹åº”ï¼Œå…‰æœ‰ HTTP é”™è¯¯ç å’Œæè¿°ä¿¡æ¯æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦å®šä¹‰ä¸“é—¨çš„é”™è¯¯æ¨¡å‹ã€‚</p> <h2 id="api-é”™è¯¯æ¨¡å‹">API é”™è¯¯æ¨¡å‹</h2> <p>å¦‚ä½•å®šä¹‰ä¸€ä¸ªå¥½çš„ API é”™è¯¯æ¨¡å‹ï¼Œè¿™éœ€è¦æ ¹æ® <code>ä¸šåŠ¡çš„å¤æ‚ç¨‹åº¦</code> æ¥å®šï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å‡ ä¸ª <code>Big Company</code> éƒ½æ˜¯æ€ä¹ˆåšçš„ã€‚</p> <p>å…ˆçœ‹ <code>twitter</code> çš„ï¼Œå…¶ä¸­çœç•¥äº†æ— å…³çš„ HTTP è¾“å‡ºä¿¡æ¯ã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code>HTTP/<span class="token number">1.1</span> <span class="token number">400</span> Bad Request

<span class="token punctuation">{</span><span class="token property">&quot;errors&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">215</span><span class="token punctuation">,</span><span class="token property">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;Bad Authentication data.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨äº†é”™è¯¯ç ï¼Œå¹¶ä¸”é”™è¯¯æ¨¡å‹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ„å‘³ç€å¯èƒ½ä¼šè¿”å›å¤šä¸ªé”™è¯¯ã€‚</p> <p>å†æ¥çœ‹ <code>Facebook</code> çš„ Graph APIã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code>HTTP/<span class="token number">1.1</span> <span class="token number">200</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Syntax error \&quot;Field picture specified more than once. This is only possible before version 2.1\&quot; at character 23: id,name,picture,picture&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OAuthException&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">2500</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fbtrace_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxxxxxxxxxx&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨æ„ï¼Œå…¶è¿”å›çš„æ˜¯ç»Ÿä¸€çš„ 200 çŠ¶æ€ç ï¼Œé”™è¯¯æ¨¡å‹ä¸­è¿˜åŒ…å« <code>å¼‚å¸¸ç±»å‹</code> å’Œ <code>trace_id</code>ï¼Œè¿™ä¸¤ä¸ªå±æ€§æœ‰åŠ©äºæ’æŸ¥é”™è¯¯ã€‚</p> <p>æœ€åçœ‹çœ‹å·¨å¤´å¾®è½¯ <code>Bing</code> çš„é”™è¯¯æ¨¡å‹ã€‚</p> <div class="language-json extra-class"><pre class="language-json"><code>HTTP/<span class="token number">1.1</span> <span class="token number">200</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;SearchResponse&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;Version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;SearchTerms&quot;</span><span class="token operator">:</span> <span class="token string">&quot;api error codes&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Errors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;Code&quot;</span><span class="token operator">:</span> <span class="token number">1001</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Required parameter is missing.&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;Parameter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SearchRequest.AppId&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;HelpUrl&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http\u003a\u002f\u002fmsdn.microsoft.com\u002fen-us\u002flibrary\u002fdd251042.aspx&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶è¿”å›çš„ä¹Ÿæ˜¯ 200 çŠ¶æ€ç ï¼Œä½†å¯ä»¥çœ‹åˆ°å®ƒä½¿ç”¨äº†ç±»ä¼¼ ApiResult çš„åŒ…è£…æ–¹å¼ï¼Œå¹¶ä¸”è¿˜åŒ…å«äº† <code>è¾“å…¥ä¿¡æ¯</code>ã€<code>è¾“å…¥å‚æ•°</code> å’Œ <code>å¸®åŠ©é“¾æ¥</code> ï¼ŒåŸæ¥è¿™å°±æ˜¯ <code>å¤§ä½¬</code> çš„åšäº‹æ–¹å¼å—ï¼Ÿ</p> <p>æœç„¶ API é”™è¯¯æ¨¡å‹çš„è®¾è®¡ï¼Œæ ¹æ®ä¸šåŠ¡å¤æ‚ç¨‹åºçš„ä¸åŒï¼Œå®ç°èµ·æ¥ä¹Ÿä¸å¤ªä¸€æ ·ï¼Œè¿™ä¸‰ä¸ªä¸­ï¼Œæˆ‘ä»¬å‚è€ƒ <code>twitter çš„ API è®¾è®¡</code> æ¥çœ‹çœ‹åœ¨ <code>Spring</code> é¡¹ç›®ä¸­å®ç°èµ·æ¥æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„ï¼Œæ¯•ç«Ÿç»å¤§å¤šæ•°é¡¹ç›®çš„å¤æ‚åº¦éƒ½è¾¾ä¸åˆ° FB å’Œ Bing çš„ç¨‹åº¦ã€‚</p> <h2 id="spring-api-é”™è¯¯æ¨¡å‹å®æˆ˜">Spring API é”™è¯¯æ¨¡å‹å®æˆ˜</h2> <p>é”™è¯¯æ¨¡å‹çš„å®šä¹‰æ˜¯éå¸¸ç®€å•çš„ï¼Œä»£ç å¦‚ä¸‹ã€‚</p> <p>ErrorResponse.java</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ErrorResponse</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">ErrorDetail</span> error<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ErrorDetail.java</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ErrorDetail</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é”™è¯¯è¯¦æƒ…ä¸­å¢åŠ äº†ä¸€ä¸ª <code>type</code> å±æ€§ï¼Œå¯ä»¥å¸®åŠ©æ›´å¥½åœ°å®šä½åˆ°å¼‚å¸¸ã€‚</p> <p>åœ¨ <code>Controller</code> å±‚ç¼–å†™æ—¶è‡³éœ€è¦è¿”å›æ­£å¸¸çš„æ•°æ®æ¨¡å‹ï¼Œå¦‚ <code>Listã€VOã€DTO</code> ä¹‹ç±»ã€‚</p> <p>å¼‚å¸¸ä½¿ç”¨ <code>AOP</code> çš„æ–¹å¼æ¥å¤„ç†ã€‚</p> <p>ç¼–å†™ä¸€ä¸ª <code>ControllerAdvice</code> ç±»ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomExceptionHandler</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">exceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">serverErrorResponse</span><span class="token punctuation">(</span><span class="token class-name">ApiCode</span><span class="token punctuation">.</span>SYSTEM_EXCEPTION<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">serverErrorResponse</span><span class="token punctuation">(</span><span class="token class-name">ApiCode</span> apiCode<span class="token punctuation">,</span> <span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> apiCode<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æœåŠ¡ç«¯å¼‚å¸¸éœ€è¦è®°å½•æ—¥å¿—</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æœåŠ¡ç«¯å¼‚å¸¸ä½¿ç”¨api codeä¸­çš„messageï¼Œé¿å…æ•æ„Ÿå¼‚å¸¸ä¿¡æ¯å‘é€åˆ°å®¢æˆ·ç«¯</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">errorResponse</span><span class="token punctuation">(</span>apiCode<span class="token punctuation">,</span> <span class="token class-name">ErrorMessageType</span><span class="token punctuation">.</span>API_CODE<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>INTERNAL_SERVER_ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">requestErrorResponse</span><span class="token punctuation">(</span><span class="token class-name">ApiCode</span> apiCode<span class="token punctuation">,</span> <span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> apiCode<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å®¢æˆ·ç«¯è¯·æ±‚é”™è¯¯åªè®°å½•debugæ—¥å¿—</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//å®¢æˆ·ç«¯å¼‚å¸¸ä½¿ç”¨å¼‚å¸¸ä¸­çš„message</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token function">errorResponse</span><span class="token punctuation">(</span>apiCode<span class="token punctuation">,</span> <span class="token class-name">ErrorMessageType</span><span class="token punctuation">.</span>EXCEPTION<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>BAD_REQUEST<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">ErrorResponse</span> <span class="token function">errorResponse</span><span class="token punctuation">(</span><span class="token class-name">ApiCode</span> code<span class="token punctuation">,</span> <span class="token class-name">ErrorMessageType</span> messageType<span class="token punctuation">,</span> <span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ErrorDetail</span> errorDetail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorDetail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorDetail<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span>code<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>messageType<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ErrorMessageType</span><span class="token punctuation">.</span>API_CODE<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>exception<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            errorDetail<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>code<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            errorDetail<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>exception<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        errorDetail<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span>exception<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ErrorResponse</span> errorResponse <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ErrorResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorResponse<span class="token punctuation">.</span><span class="token function">setError</span><span class="token punctuation">(</span>errorDetail<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> errorResponse<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">RequestVerifyException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">requestVerifyExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">RequestVerifyException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">requestErrorResponse</span><span class="token punctuation">(</span><span class="token class-name">ApiCode</span><span class="token punctuation">.</span>PARAMETER_EXCEPTION<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šé¢çš„ä»£ç åªæ”¾äº†ä¸¤ä¸ª <code>ExceptionHandler</code> ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹ <code>è¯·æ±‚éªŒè¯é”™è¯¯</code> ï¼Œä¸€ä¸ªæ˜¯é’ˆå¯¹ <code>æœªçŸ¥æœåŠ¡å™¨é”™è¯¯</code> ï¼Œåˆ†åˆ«å¯¹åº”çš„æ˜¯ <code>400</code> å’Œ <code>500</code> çš„ HTTP çŠ¶æ€ç ã€‚éœ€è¦å¯¹å…¶ä»–å¼‚å¸¸åšä¸“é—¨å¤„ç†ï¼Œä¹Ÿä»ç„¶æ˜¯ä½¿ç”¨ä»¥ä¸Šçš„å…¬å…± <code>errorResponse</code> æ–¹æ³•ï¼Œå°±çœ‹å¼‚å¸¸è¢«å®šä¹‰ä¸º <code>è¯·æ±‚å¼‚å¸¸</code> è¿˜æ˜¯ <code>æœåŠ¡ç«¯å¼‚å¸¸</code> ã€‚</p> <p>è‡³æ­¤ï¼ŒAPI å°±èƒ½è¿”å› <code>&quot;æ¼‚äº®&quot;</code> çš„é”™è¯¯æ¨¡å‹äº†ã€‚</p> <h2 id="ç»“æŸäº†å—">ç»“æŸäº†å—ï¼Ÿ</h2> <p>å…ˆåˆ«èµ°ï¼Œè¿˜æ²¡ç»“æŸå‘¢ï¼Œå¦‚æœæ­£å¸¸å’Œé”™è¯¯æƒ…å†µä¸‹è¿”å›çš„æ•°æ®æ¨¡å‹ä¸ä¸€æ ·ï¼Œé‚£æ¥å£æ–‡æ¡£è¯¥å¦‚ä½•å®šä¹‰å‘¢ï¼Ÿå¦‚æœä½¿ç”¨äº† swagger ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ·»åŠ é’ˆå¯¹ 400 å’Œ 500 çŠ¶æ€ç çš„ <code>å…¨å±€è¾“å‡ºæ¨¡å‹</code>ã€‚</p> <p>åœ¨æœ€æ–°ç‰ˆæœ¬çš„ <code>springfox</code> ä¸­è¦å®ç°èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹è´¹åŠ²çš„ï¼Œæ¥çœ‹éƒ¨åˆ†ä»£ç ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">Docket</span> <span class="token function">createRestApi</span><span class="token punctuation">(</span><span class="token class-name">TypeResolver</span> typeResolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//é™„åŠ é”™è¯¯æ¨¡å‹</span>
    <span class="token class-name">Docket</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>SWAGGER_2<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">host</span><span class="token punctuation">(</span>swaggerProperties<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token function">apiInfo</span><span class="token punctuation">(</span>swaggerProperties<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">additionalModels</span><span class="token punctuation">(</span>typeResolver<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token class-name">ErrorResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//æ·»åŠ 400é”™è¯¯ç è¾“å‡ºæ¨¡å‹</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Response</span><span class="token punctuation">&gt;</span></span> responseMessages <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ResponseBuilder</span> responseBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResponseBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    responseBuilder<span class="token punctuation">.</span><span class="token function">code</span><span class="token punctuation">(</span><span class="token string">&quot;400&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>globalResponseMessageBody<span class="token punctuation">.</span><span class="token function">getModelRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        responseBuilder<span class="token punctuation">.</span><span class="token function">representation</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span>APPLICATION_JSON<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>rep <span class="token operator">-&gt;</span> rep<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span>m <span class="token operator">-&gt;</span> m<span class="token punctuation">.</span><span class="token function">referenceModel</span><span class="token punctuation">(</span>
                re <span class="token operator">-&gt;</span> re<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>key<span class="token operator">-&gt;</span>key<span class="token punctuation">.</span><span class="token function">qualifiedModelName</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QualifiedModelName</span><span class="token punctuation">(</span><span class="token string">&quot;com.package.api&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;ErrorResponse&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    responseMessages<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>responseBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    builder<span class="token punctuation">.</span><span class="token function">useDefaultResponseMessages</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">globalResponses</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span>GET<span class="token punctuation">,</span> responseMessages<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">globalResponses</span><span class="token punctuation">(</span><span class="token class-name">HttpMethod</span><span class="token punctuation">.</span>POST<span class="token punctuation">,</span> responseMessages<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»¥ä¸Šä»…ä¸ºéƒ¨åˆ†ä»£ç ï¼Œä¸»è¦åœ¨äº <code>éœ€è¦é™„åŠ æ¨¡å‹</code> å¹¶æŒ‡å®šè¾“å‡ºæ¨¡å‹ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­åº”è¯¥å°†æ¨¡å‹ä¿¡æ¯æ”¾åœ¨é…ç½®å½“ä¸­ï¼Œæ ¹æ®é…ç½®è‡ªåŠ¨æ·»åŠ ï¼Œå…³äº swagger çš„è‡ªåŠ¨é…ç½®ï¼Œè‹¥è¯»è€…æœ‹å‹æ„Ÿå…´è¶£ï¼Œå¯ä»¥æœ‰æœºä¼šä¸“é—¨å†™ç¯‡æ–‡ç« æ¥è®²è§£ã€‚</p> <h2 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h2> <p>åœ¨æ¯ä¸ªæ¥å£ä¸­è¿”å›ç»Ÿä¸€çš„ ApiResultï¼Œç¬”è€…è§‰å¾—æ˜¯ä¸€ä»¶æŒºæ— èŠçš„äº‹æƒ…ï¼Œå†™ç¨‹åºåº”è¯¥æ˜¯ä¸€ä»¶èƒ½å‘æŒ¥åˆ›é€ åŠ›çš„äº‹æƒ…ã€‚ä¸æ–­å»æ€è€ƒæœ€ä½³å®è·µï¼Œå­¦ä¹ ä¼˜ç§€çš„è®¾è®¡ï¼Œè¿™ä»¶å°å°çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åœ¨å·¥ä½œå½“ä¸­å‡ ä¹æ¯å¤©éƒ½ä¼šç¢°åˆ°ï¼Œå®ƒæ˜¯å€¼å¾—è¢«æ”¹è¿›çš„ã€‚</p></div> <footer class="page-edit"><!----> <div class="git-hub-star"><span class="prefix"><span style="position:relative;top:4px;right:-4px;"><a href="https://github.com/lcomplete/TechShare" aria-label="Star lcomplete/TechShare on GitHub" data-icon="octicon-star" data-show-count="true">
      Star
    </a></span></span></div> <div class="last-updated"><span class="prefix">æ€»å­—æ•°:</span> <span class="words">2,024</span> <span class="prefix">å­—ã€€</span> <span class="prefix">æœ€åæ›´æ–°:</span> <span class="time">7/16/2021, 1:09:14 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
    â†
    <a href="/TechShare/docs/java/unit_test.html" class="prev">
      [Java å¼€å‘å®æˆ˜] é«˜çº§å·¥ç¨‹å¸ˆçš„è‡ªæˆ‘ä¿®å…»ä¹‹å•å…ƒæµ‹è¯•ï¼ˆä¸€ï¼‰ï¼šDAO å±‚æµ‹è¯•
    </a></span> <span class="next"><a href="/TechShare/docs/java/spring_best_practice.html">
      Java Spring é¡¹ç›®å¼€å‘æœ€ä½³å®è·µ
    </a>
    â†’
  </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/TechShare/assets/js/app.832ed307.js" defer></script><script src="/TechShare/assets/js/3.df2e8613.js" defer></script><script src="/TechShare/assets/js/4.4084e14b.js" defer></script><script src="/TechShare/assets/js/29.55e38d98.js" defer></script><script src="/TechShare/assets/js/17.73d469d0.js" defer></script>
  </body>
</html>
